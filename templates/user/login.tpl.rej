***************
*** 38,44 ****
  	<form id="signinForm" name="login" method="post" action="{$loginUrl}">
  {/if}
  
- <input type="hidden" name="source" value="{$source|escape}" />
  
  {if ! $implicitAuth}
  	<table id="signinTable" class="data">
--- 38,44 ----
  	<form id="signinForm" name="login" method="post" action="{$loginUrl}">
  {/if}
  
+ <input type="hidden" name="source" value="{$source|strip_unsafe_html|escape}" />
  
  {if ! $implicitAuth}
  	<table id="signinTable" class="data">
